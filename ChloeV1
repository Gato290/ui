local HttpService = game:GetService("HttpService") -- V1.0.0 Nexa Hub

-- Configuration System
if not isfolder("NexaHub") then
    makefolder("NexaHub")
end
if not isfolder("NexaHub/Config") then
    makefolder("NexaHub/Config")
end

local gameName = tostring(game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name)
gameName = gameName:gsub("[^%w_ ]", "")
gameName = gameName:gsub("%s+", "_")

local ConfigFile = "NexaHub/Config/NEXA_" .. gameName .. ".json"
ConfigData = {}
Elements = {}
CURRENT_VERSION = nil

-- Theme Manager
local Themes = {
    Default = Color3.fromRGB(0, 208, 255),
    Dark = Color3.fromRGB(25, 25, 25),
    Light = Color3.fromRGB(240, 240, 240),
    Ocean = Color3.fromRGB(0, 150, 255),
    Fire = Color3.fromRGB(255, 50, 50),
    Neon = Color3.fromRGB(0, 255, 200),
    Royal = Color3.fromRGB(138, 43, 226)
}

function SaveConfig()
    if writefile then
        ConfigData._version = CURRENT_VERSION
        ConfigData._lastSave = os.time()
        writefile(ConfigFile, HttpService:JSONEncode(ConfigData))
    end
end

function LoadConfigFromFile()
    if not CURRENT_VERSION then return end
    if isfile and isfile(ConfigFile) then
        local success, result = pcall(function()
            return HttpService:JSONDecode(readfile(ConfigFile))
        end)
        if success and type(result) == "table" then
            if result._version == CURRENT_VERSION then
                ConfigData = result
            else
                ConfigData = { _version = CURRENT_VERSION }
            end
        else
            ConfigData = { _version = CURRENT_VERSION }
        end
    else
        ConfigData = { _version = CURRENT_VERSION }
    end
end

function LoadConfigElements()
    for key, element in pairs(Elements) do
        if ConfigData[key] ~= nil and element.Set then
            element:Set(ConfigData[key], true)
        end
    end
end

-- Enhanced Icons Library
local Icons = {
    -- Core
    Nt = "rbxassetid://84946340265305",
    player = "rbxassetid://12120698352",
    settings = "rbxassetid://70386228443175",
    menu = "rbxassetid://6340513838",
    user = "rbxassetid://108483430622128",
    discord = "rbxassetid://94434236999817",
    star = "rbxassetid://107005941750079",
    alert = "rbxassetid://73186275216515",
    
    -- Game
    sword = "rbxassetid://82472368671405",
    gamepad = "rbxassetid://84173963561612",
    bag = "rbxassetid://8601111810",
    shop = "rbxassetid://4985385964",
    boss = "rbxassetid://13132186360",
    crosshair = "rbxassetid://12614416478",
    
    -- Utility
    web = "rbxassetid://137601480983962",
    plug = "rbxassetid://137601480983962",
    loop = "rbxassetid://122032243989747",
    gps = "rbxassetid://17824309485",
    compas = "rbxassetid://125300760963399",
    scan = "rbxassetid://109869955247116",
    idea = "rbxassetid://16833255748",
    
    -- Status
    stat = "rbxassetid://12094445329",
    eyes = "rbxassetid://14321059114",
    skeleton = "rbxassetid://17313330026",
    strom = "rbxassetid://13321880293",
    water = "rbxassetid://100076212630732",
    
    -- Actions
    start = "rbxassetid://108886429866687",
    next = "rbxassetid://12662718374",
    rod = "rbxassetid://103247953194129",
    fish = "rbxassetid://97167558235554",
    
    -- Modern Additions
    home = "rbxassetid://6031068421",
    search = "rbxassetid://6031302919",
    bell = "rbxassetid://6031302926",
    heart = "rbxassetid://6031302933",
    download = "rbxassetid://6031302940",
    upload = "rbxassetid://6031302947",
    lock = "rbxassetid://6031302954",
    unlock = "rbxassetid://6031302961",
    camera = "rbxassetid://6031302968",
    chart = "rbxassetid://6031302975",
    clock = "rbxassetid://6031302982",
    cloud = "rbxassetid://6031302989",
    code = "rbxassetid://6031302996",
    cpu = "rbxassetid://6031303003",
    database = "rbxassetid://6031303010"
}

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local CoreGui = game:GetService("CoreGui")
local viewport = workspace.CurrentCamera.ViewportSize

-- Device Detection
local function isMobileDevice()
    return UserInputService.TouchEnabled
        and not UserInputService.KeyboardEnabled
        and not UserInputService.MouseEnabled
end

local isMobile = isMobileDevice()

-- Responsive Sizing
local function safeSize(pxWidth, pxHeight)
    local scaleX = pxWidth / viewport.X
    local scaleY = pxHeight / viewport.Y

    if isMobile then
        if scaleX > 0.5 then scaleX = 0.5 end
        if scaleY > 0.3 then scaleY = 0.3 end
    end

    return UDim2.new(scaleX, 0, scaleY, 0)
end

-- Draggable System
local function MakeDraggable(topbarobject, object)
    local dragging, dragInput, dragStart, startPosition
    local dragSpeed = 0.15 -- Smoother dragging

    local function Update(input)
        local delta = input.Position - dragStart
        local pos = UDim2.new(
            startPosition.X.Scale,
            startPosition.X.Offset + delta.X,
            startPosition.Y.Scale,
            startPosition.Y.Offset + delta.Y
        )
        TweenService:Create(object, TweenInfo.new(dragSpeed), { Position = pos }):Play()
    end

    topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPosition = object.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            Update(input)
        end
    end)
end

-- Resizable System
local function MakeResizable(object, minWidth, minHeight)
    local dragging, dragInput, dragStart, startSize
    
    minWidth = minWidth or 150
    minHeight = minHeight or 150

    local resizeHandle = Instance.new("ImageButton")
    resizeHandle.Name = "ResizeHandle"
    resizeHandle.Image = "rbxassetid://6031302933" -- Corner icon
    resizeHandle.ImageColor3 = Color3.fromRGB(150, 150, 150)
    resizeHandle.ImageTransparency = 0.7
    resizeHandle.BackgroundTransparency = 1
    resizeHandle.Size = UDim2.new(0, 20, 0, 20)
    resizeHandle.Position = UDim2.new(1, -20, 1, -20)
    resizeHandle.Parent = object

    local function UpdateSize(input)
        local delta = input.Position - dragStart
        local newWidth = math.max(startSize.X.Offset + delta.X, minWidth)
        local newHeight = math.max(startSize.Y.Offset + delta.Y, minHeight)
        
        TweenService:Create(object, TweenInfo.new(0.15), { 
            Size = UDim2.new(0, newWidth, 0, newHeight) 
        }):Play()
    end

    resizeHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startSize = object.Size
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    resizeHandle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            UpdateSize(input)
        end
    end)
end

-- Enhanced Click Effect
function RippleClick(button, x, y)
    button.ClipsDescendants = true
    
    local ripple = Instance.new("Frame")
    ripple.Name = "Ripple"
    ripple.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ripple.BackgroundTransparency = 0.8
    ripple.ZIndex = 10
    ripple.Parent = button
    
    local newX = x - button.AbsolutePosition.X
    local newY = y - button.AbsolutePosition.Y
    ripple.Position = UDim2.new(0, newX, 0, newY)
    ripple.Size = UDim2.new(0, 0, 0, 0)
    
    local size = math.max(button.AbsoluteSize.X, button.AbsoluteSize.Y) * 2
    local time = 0.5
    
    TweenService:Create(ripple, TweenInfo.new(time, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, size, 0, size),
        Position = UDim2.new(0.5, -size/2, 0.5, -size/2),
        BackgroundTransparency = 1
    }):Play()
    
    delay(time, function()
        ripple:Destroy()
    end)
end

-- Modern Notification System
local NexaNotifications = {}
function NexaNotifications:Notify(NotifyConfig)
    NotifyConfig = NotifyConfig or {}
    NotifyConfig.Title = NotifyConfig.Title or "Nexa Hub"
    NotifyConfig.Description = NotifyConfig.Description or "Notification"
    NotifyConfig.Content = NotifyConfig.Content or "Content"
    NotifyConfig.Color = NotifyConfig.Color or Themes.Default
    NotifyConfig.Time = NotifyConfig.Time or 0.3
    NotifyConfig.Delay = NotifyConfig.Delay or 4
    NotifyConfig.Icon = NotifyConfig.Icon or Icons.alert
    
    local Notification = {}
    
    spawn(function()
        if not CoreGui:FindFirstChild("NexaNotifications") then
            local NotifyGui = Instance.new("ScreenGui")
            NotifyGui.Name = "NexaNotifications"
            NotifyGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
            NotifyGui.Parent = CoreGui
        end
        
        if not CoreGui.NexaNotifications:FindFirstChild("NotifyLayout") then
            local layout = Instance.new("Frame")
            layout.Name = "NotifyLayout"
            layout.AnchorPoint = Vector2.new(1, 1)
            layout.BackgroundTransparency = 1
            layout.Position = UDim2.new(1, -20, 1, -20)
            layout.Size = UDim2.new(0, 350, 1, 0)
            layout.Parent = CoreGui.NexaNotifications
            
            local uiList = Instance.new("UIListLayout")
            uiList.Padding = UDim.new(0, 10)
            uiList.SortOrder = Enum.SortOrder.LayoutOrder
            uiList.Parent = layout
        end
        
        local notificationFrame = Instance.new("Frame")
        notificationFrame.Name = "Notification"
        notificationFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
        notificationFrame.BackgroundTransparency = 0.1
        notificationFrame.BorderSizePixel = 0
        notificationFrame.Size = UDim2.new(1, 0, 0, 0)
        notificationFrame.LayoutOrder = 999
        notificationFrame.Parent = CoreGui.NexaNotifications.NotifyLayout
        
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 8)
        corner.Parent = notificationFrame
        
        local glow = Instance.new("ImageLabel")
        glow.Name = "Glow"
        glow.Image = "rbxassetid://5012538253"
        glow.ImageColor3 = NotifyConfig.Color
        glow.ImageTransparency = 0.8
        glow.BackgroundTransparency = 1
        glow.Size = UDim2.new(1, 20, 1, 20)
        glow.Position = UDim2.new(0, -10, 0, -10)
        glow.ZIndex = -1
        glow.Parent = notificationFrame
        
        local topBar = Instance.new("Frame")
        topBar.Name = "TopBar"
        topBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        topBar.BackgroundTransparency = 0.5
        topBar.Size = UDim2.new(1, 0, 0, 40)
        topBar.Parent = notificationFrame
        
        local icon = Instance.new("ImageLabel")
        icon.Name = "Icon"
        icon.Image = NotifyConfig.Icon
        icon.ImageColor3 = NotifyConfig.Color
        icon.BackgroundTransparency = 1
        icon.Size = UDim2.new(0, 20, 0, 20)
        icon.Position = UDim2.new(0, 10, 0.5, -10)
        icon.Parent = topBar
        
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Name = "Title"
        titleLabel.Text = NotifyConfig.Title
        titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextSize = 14
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.BackgroundTransparency = 1
        titleLabel.Position = UDim2.new(0, 40, 0, 0)
        titleLabel.Size = UDim2.new(1, -50, 1, 0)
        titleLabel.Parent = topBar
        
        local descriptionLabel = Instance.new("TextLabel")
        descriptionLabel.Name = "Description"
        descriptionLabel.Text = NotifyConfig.Description
        descriptionLabel.TextColor3 = NotifyConfig.Color
        descriptionLabel.Font = Enum.Font.GothamBold
        descriptionLabel.TextSize = 12
        descriptionLabel.TextXAlignment = Enum.TextXAlignment.Left
        descriptionLabel.BackgroundTransparency = 1
        descriptionLabel.Position = UDim2.new(0, 40, 0, 15)
        descriptionLabel.Size = UDim2.new(1, -50, 0, 12)
        descriptionLabel.Parent = topBar
        
        local closeButton = Instance.new("ImageButton")
        closeButton.Name = "CloseButton"
        closeButton.Image = "rbxassetid://9886659671"
        closeButton.ImageColor3 = Color3.fromRGB(150, 150, 150)
        closeButton.BackgroundTransparency = 1
        closeButton.Size = UDim2.new(0, 20, 0, 20)
        closeButton.Position = UDim2.new(1, -30, 0.5, -10)
        closeButton.Parent = topBar
        
        local contentFrame = Instance.new("Frame")
        contentFrame.Name = "ContentFrame"
        contentFrame.BackgroundTransparency = 1
        contentFrame.Position = UDim2.new(0, 0, 0, 40)
        contentFrame.Size = UDim2.new(1, 0, 0, 0)
        contentFrame.Parent = notificationFrame
        
        local contentLabel = Instance.new("TextLabel")
        contentLabel.Name = "Content"
        contentLabel.Text = NotifyConfig.Content
        contentLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        contentLabel.Font = Enum.Font.Gotham
        contentLabel.TextSize = 12
        contentLabel.TextXAlignment = Enum.TextXAlignment.Left
        contentLabel.TextYAlignment = Enum.TextYAlignment.Top
        contentLabel.BackgroundTransparency = 1
        contentLabel.TextWrapped = true
        contentLabel.Size = UDim2.new(1, -20, 0, 0)
        contentLabel.Position = UDim2.new(0, 10, 0, 10)
        contentLabel.Parent = contentFrame
        
        -- Calculate content height
        contentLabel:GetPropertyChangedSignal("TextBounds"):Connect(function()
            contentLabel.Size = UDim2.new(1, -20, 0, contentLabel.TextBounds.Y)
            contentFrame.Size = UDim2.new(1, 0, 0, contentLabel.TextBounds.Y + 20)
            notificationFrame.Size = UDim2.new(1, 0, 0, contentLabel.TextBounds.Y + 60)
        end)
        
        contentLabel:GetPropertyChangedSignal("TextBounds"):Fire()
        
        function Notification:Close()
            TweenService:Create(notificationFrame, TweenInfo.new(NotifyConfig.Time), {
                Size = UDim2.new(1, 0, 0, 0),
                BackgroundTransparency = 1
            }):Play()
            delay(NotifyConfig.Time, function()
                notificationFrame:Destroy()
            end)
        end
        
        closeButton.MouseButton1Click:Connect(function()
            Notification:Close()
        end)
        
        -- Animation
        notificationFrame.Size = UDim2.new(1, 0, 0, 0)
        TweenService:Create(notificationFrame, TweenInfo.new(NotifyConfig.Time), {
            Size = UDim2.new(1, 0, 0, contentLabel.TextBounds.Y + 60)
        }):Play()
        
        delay(NotifyConfig.Delay, function()
            Notification:Close()
        end)
    end)
    
    return Notification
end

function Nt(msg, delay, color, title, desc, icon)
    return NexaNotifications:Notify({
        Title = title or "Nexa Hub",
        Description = desc or "Notification",
        Content = msg or "Content",
        Color = color or Themes.Default,
        Delay = delay or 4,
        Icon = icon or Icons.alert
    })
end

-- Main Window Class
local Nexa = {}

function Nexa:Window(WindowConfig)
    WindowConfig = WindowConfig or {}
    WindowConfig.Title = WindowConfig.Title or "Nexa Hub"
    WindowConfig.Footer = WindowConfig.Footer or "Nexa Hub v1.0.0"
    WindowConfig.Color = WindowConfig.Color or Themes.Default
    WindowConfig.TabWidth = WindowConfig.TabWidth or 140
    WindowConfig.Version = WindowConfig.Version or 1.0
    WindowConfig.Theme = WindowConfig.Theme or "Default"
    WindowConfig.AccentColor = WindowConfig.AccentColor or WindowConfig.Color
    WindowConfig.ShowMinimize = WindowConfig.ShowMinimize ~= false
    WindowConfig.ShowClose = WindowConfig.ShowClose ~= false
    WindowConfig.Resizable = WindowConfig.Resizable ~= false
    WindowConfig.Draggable = WindowConfig.Draggable ~= false
    WindowConfig.AutoLoadConfig = WindowConfig.AutoLoadConfig ~= false
    WindowConfig.DefaultSize = WindowConfig.DefaultSize or (isMobile and Vector2.new(470, 270) or Vector2.new(640, 400))
    
    CURRENT_VERSION = WindowConfig.Version
    
    if WindowConfig.AutoLoadConfig then
        LoadConfigFromFile()
    end
    
    local Window = {}
    local Tabs = {}
    local ActiveTab = nil
    local WindowOpen = true
    
    -- Create Main GUI
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "NexaHub"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = CoreGui
    
    local MainContainer = Instance.new("Frame")
    MainContainer.Name = "MainContainer"
    MainContainer.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    MainContainer.BackgroundTransparency = 0.05
    MainContainer.BorderSizePixel = 0
    MainContainer.Size = UDim2.new(0, WindowConfig.DefaultSize.X, 0, WindowConfig.DefaultSize.Y)
    MainContainer.Position = UDim2.new(0.5, -WindowConfig.DefaultSize.X/2, 0.5, -WindowConfig.DefaultSize.Y/2)
    MainContainer.Parent = ScreenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = MainContainer
    
    local DropShadow = Instance.new("ImageLabel")
    DropShadow.Name = "DropShadow"
    DropShadow.Image = "rbxassetid://6015897843"
    DropShadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    DropShadow.ImageTransparency = 0.8
    DropShadow.ScaleType = Enum.ScaleType.Slice
    DropShadow.SliceCenter = Rect.new(49, 49, 450, 450)
    DropShadow.Size = UDim2.new(1, 50, 1, 50)
    DropShadow.Position = UDim2.new(0, -25, 0, -25)
    DropShadow.BackgroundTransparency = 1
    DropShadow.ZIndex = -1
    DropShadow.Parent = MainContainer
    
    -- Title Bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Name = "TitleBar"
    TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    TitleBar.BackgroundTransparency = 0.1
    TitleBar.Size = UDim2.new(1, 0, 0, 40)
    TitleBar.Parent = MainContainer
    
    local TitleBarCorner = Instance.new("UICorner")
    TitleBarCorner.CornerRadius = UDim.new(0, 8, 0, 0)
    TitleBarCorner.Parent = TitleBar
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Name = "Title"
    TitleLabel.Text = WindowConfig.Title
    TitleLabel.TextColor3 = WindowConfig.Color
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 16
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Size = UDim2.new(1, -100, 1, 0)
    TitleLabel.Position = UDim2.new(0, 15, 0, 0)
    TitleLabel.Parent = TitleBar
    
    local FooterLabel = Instance.new("TextLabel")
    FooterLabel.Name = "Footer"
    FooterLabel.Text = WindowConfig.Footer
    FooterLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    FooterLabel.Font = Enum.Font.Gotham
    FooterLabel.TextSize = 12
    FooterLabel.TextXAlignment = Enum.TextXAlignment.Left
    FooterLabel.BackgroundTransparency = 1
    FooterLabel.Position = UDim2.new(0, TitleLabel.TextBounds.X + 25, 0, 0)
    FooterLabel.Size = UDim2.new(1, -(TitleLabel.TextBounds.X + 30), 1, 0)
    FooterLabel.Parent = TitleBar
    
    local ControlButtons = Instance.new("Frame")
    ControlButtons.Name = "ControlButtons"
    ControlButtons.BackgroundTransparency = 1
    ControlButtons.Size = UDim2.new(0, 60, 1, 0)
    ControlButtons.Position = UDim2.new(1, -65, 0, 0)
    ControlButtons.Parent = TitleBar
    
    local CloseButton
    if WindowConfig.ShowClose then
        CloseButton = Instance.new("ImageButton")
        CloseButton.Name = "CloseButton"
        CloseButton.Image = "rbxassetid://9886659671"
        CloseButton.ImageColor3 = Color3.fromRGB(255, 100, 100)
        CloseButton.BackgroundTransparency = 1
        CloseButton.Size = UDim2.new(0, 25, 0, 25)
        CloseButton.Position = UDim2.new(1, -30, 0.5, -12.5)
        CloseButton.Parent = ControlButtons
        
        CloseButton.MouseButton1Click:Connect(function()
            RippleClick(CloseButton, Mouse.X, Mouse.Y)
            local overlay = Instance.new("Frame")
            overlay.Name = "CloseOverlay"
            overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
            overlay.BackgroundTransparency = 0.5
            overlay.Size = UDim2.new(1, 0, 1, 0)
            overlay.ZIndex = 50
            overlay.Parent = ScreenGui
            
            local dialog = Instance.new("Frame")
            dialog.Name = "CloseDialog"
            dialog.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
            dialog.Size = UDim2.new(0, 300, 0, 150)
            dialog.Position = UDim2.new(0.5, -150, 0.5, -75)
            dialog.ZIndex = 51
            dialog.Parent = overlay
            
            local dialogCorner = Instance.new("UICorner")
            dialogCorner.CornerRadius = UDim.new(0, 8)
            dialogCorner.Parent = dialog
            
            local title = Instance.new("TextLabel")
            title.Text = "Close Window"
            title.TextColor3 = Color3.fromRGB(255, 255, 255)
            title.Font = Enum.Font.GothamBold
            title.TextSize = 18
            title.BackgroundTransparency = 1
            title.Size = UDim2.new(1, 0, 0, 40)
            title.Parent = dialog
            
            local message = Instance.new("TextLabel")
            message.Text = "Are you sure you want to close Nexa Hub?"
            message.TextColor3 = Color3.fromRGB(200, 200, 200)
            message.Font = Enum.Font.Gotham
            message.TextSize = 14
            message.BackgroundTransparency = 1
            message.Size = UDim2.new(1, -20, 0, 50)
            message.Position = UDim2.new(0, 10, 0, 40)
            message.TextWrapped = true
            message.Parent = dialog
            
            local buttonContainer = Instance.new("Frame")
            buttonContainer.BackgroundTransparency = 1
            buttonContainer.Size = UDim2.new(1, -20, 0, 40)
            buttonContainer.Position = UDim2.new(0, 10, 1, -50)
            buttonContainer.Parent = dialog
            
            local cancelBtn = Instance.new("TextButton")
            cancelBtn.Text = "Cancel"
            cancelBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            cancelBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            cancelBtn.Font = Enum.Font.GothamBold
            cancelBtn.TextSize = 14
            cancelBtn.Size = UDim2.new(0.45, 0, 1, 0)
            cancelBtn.Parent = buttonContainer
            
            local cancelCorner = Instance.new("UICorner")
            cancelCorner.CornerRadius = UDim.new(0, 6)
            cancelCorner.Parent = cancelBtn
            
            local confirmBtn = Instance.new("TextButton")
            confirmBtn.Text = "Confirm"
            confirmBtn.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
            confirmBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            confirmBtn.Font = Enum.Font.GothamBold
            confirmBtn.TextSize = 14
            confirmBtn.Size = UDim2.new(0.45, 0, 1, 0)
            confirmBtn.Position = UDim2.new(0.55, 0, 0, 0)
            confirmBtn.Parent = buttonContainer
            
            local confirmCorner = Instance.new("UICorner")
            confirmCorner.CornerRadius = UDim.new(0, 6)
            confirmCorner.Parent = confirmBtn
            
            cancelBtn.MouseButton1Click:Connect(function()
                overlay:Destroy()
            end)
            
            confirmBtn.MouseButton1Click:Connect(function()
                ScreenGui:Destroy()
                WindowOpen = false
            end)
        end)
    end
    
    local MinButton
    if WindowConfig.ShowMinimize then
        MinButton = Instance.new("ImageButton")
        MinButton.Name = "MinButton"
        MinButton.Image = "rbxassetid://9886659276"
        MinButton.ImageColor3 = Color3.fromRGB(150, 150, 150)
        MinButton.BackgroundTransparency = 1
        MinButton.Size = UDim2.new(0, 25, 0, 25)
        MinButton.Position = UDim2.new(1, -65, 0.5, -12.5)
        MinButton.Parent = ControlButtons
        
        MinButton.MouseButton1Click:Connect(function()
            RippleClick(MinButton, Mouse.X, Mouse.Y)
            MainContainer.Visible = not MainContainer.Visible
        end)
    end
    
    -- Make draggable
    if WindowConfig.Draggable then
        MakeDraggable(TitleBar, MainContainer)
    end
    
    -- Make resizable
    if WindowConfig.Resizable then
        MakeResizable(MainContainer, 300, 200)
    end
    
    -- Main Content Area
    local ContentArea = Instance.new("Frame")
    ContentArea.Name = "ContentArea"
    ContentArea.BackgroundTransparency = 1
    ContentArea.Size = UDim2.new(1, 0, 1, -40)
    ContentArea.Position = UDim2.new(0, 0, 0, 40)
    ContentArea.Parent = MainContainer
    
    -- Tab Navigation
    local TabNavigation = Instance.new("Frame")
    TabNavigation.Name = "TabNavigation"
    TabNavigation.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    TabNavigation.BackgroundTransparency = 0.1
    TabNavigation.Size = UDim2.new(0, WindowConfig.TabWidth, 1, 0)
    TabNavigation.Parent = ContentArea
    
    local TabNavCorner = Instance.new("UICorner")
    TabNavCorner.CornerRadius = UDim.new(0, 0, 0, 8)
    TabNavCorner.Parent = TabNavigation
    
    local TabScroll = Instance.new("ScrollingFrame")
    TabScroll.Name = "TabScroll"
    TabScroll.BackgroundTransparency = 1
    TabScroll.Size = UDim2.new(1, 0, 1, -10)
    TabScroll.Position = UDim2.new(0, 0, 0, 5)
    TabScroll.ScrollBarThickness = 0
    TabScroll.ScrollBarImageTransparency = 1
    TabScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    TabScroll.Parent = TabNavigation
    
    local TabList = Instance.new("UIListLayout")
    TabList.Padding = UDim.new(0, 5)
    TabList.SortOrder = Enum.SortOrder.LayoutOrder
    TabList.Parent = TabScroll
    
    TabList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabScroll.CanvasSize = UDim2.new(0, 0, 0, TabList.AbsoluteContentSize.Y + 10)
    end)
    
    -- Tab Content Area
    local TabContent = Instance.new("Frame")
    TabContent.Name = "TabContent"
    TabContent.BackgroundTransparency = 1
    TabContent.Size = UDim2.new(1, -WindowConfig.TabWidth - 5, 1, 0)
    TabContent.Position = UDim2.new(0, WindowConfig.TabWidth + 5, 0, 0)
    TabContent.Parent = ContentArea
    
    local TabTitle = Instance.new("TextLabel")
    TabTitle.Name = "TabTitle"
    TabTitle.Text = "Welcome"
    TabTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    TabTitle.Font = Enum.Font.GothamBold
    TabTitle.TextSize = 20
    TabTitle.BackgroundTransparency = 1
    TabTitle.Size = UDim2.new(1, 0, 0, 30)
    TabTitle.Parent = TabContent
    
    local ContentScroll = Instance.new("ScrollingFrame")
    ContentScroll.Name = "ContentScroll"
    ContentScroll.BackgroundTransparency = 1
    ContentScroll.Size = UDim2.new(1, 0, 1, -35)
    ContentScroll.Position = UDim2.new(0, 0, 0, 35)
    ContentScroll.ScrollBarThickness = 4
    ContentScroll.ScrollBarImageColor3 = WindowConfig.Color
    ContentScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    ContentScroll.Parent = TabContent
    
    local ContentList = Instance.new("UIListLayout")
    ContentList.Padding = UDim.new(0, 10)
    ContentList.SortOrder = Enum.SortOrder.LayoutOrder
    ContentList.Parent = ContentScroll
    
    ContentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        ContentScroll.CanvasSize = UDim2.new(0, 0, 0, ContentList.AbsoluteContentSize.Y + 20)
    end)
    
    -- Toggle UI Button
    local ToggleButton = Instance.new("ImageButton")
    ToggleButton.Name = "ToggleUIButton"
    ToggleButton.Image = Icons.Nt or Icons.menu
    ToggleButton.ImageColor3 = WindowConfig.Color
    ToggleButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    ToggleButton.BackgroundTransparency = 0.1
    ToggleButton.Size = UDim2.new(0, 40, 0, 40)
    ToggleButton.Position = UDim2.new(0, 20, 0, 20)
    ToggleButton.Parent = CoreGui
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 8)
    ToggleCorner.Parent = ToggleButton
    
    ToggleButton.MouseButton1Click:Connect(function()
        MainContainer.Visible = not MainContainer.Visible
    end)
    
    -- Make toggle button draggable
    MakeDraggable(ToggleButton, ToggleButton)
    
    -- Window Methods
    function Window:SetTitle(newTitle)
        TitleLabel.Text = newTitle
        WindowConfig.Title = newTitle
    end
    
    function Window:SetColor(newColor)
        WindowConfig.Color = newColor
        TitleLabel.TextColor3 = newColor
        ContentScroll.ScrollBarImageColor3 = newColor
        ToggleButton.ImageColor3 = newColor
    end
    
    function Window:ToggleVisibility()
        MainContainer.Visible = not MainContainer.Visible
    end
    
    function Window:IsOpen()
        return WindowOpen
    end
    
    function Window:Destroy()
        ScreenGui:Destroy()
        if CoreGui:FindFirstChild("ToggleUIButton") then
            CoreGui.ToggleUIButton:Destroy()
        end
        WindowOpen = false
    end
    
    function Window:SaveConfig()
        SaveConfig()
        Nt("Configuration saved successfully!", 2, Color3.fromRGB(0, 255, 100))
    end
    
    function Window:LoadConfig()
        LoadConfigElements()
        Nt("Configuration loaded successfully!", 2, Color3.fromRGB(0, 200, 255))
    end
    
    function Window:ResetConfig()
        ConfigData = { _version = CURRENT_VERSION }
        SaveConfig()
        LoadConfigElements()
        Nt("Configuration reset to defaults!", 2, Color3.fromRGB(255, 150, 0))
    end
    
    -- Tab System
    function Window:AddTab(TabConfig)
        TabConfig = TabConfig or {}
        TabConfig.Name = TabConfig.Name or "New Tab"
        TabConfig.Icon = TabConfig.Icon or Icons.home
        TabConfig.Description = TabConfig.Description or ""
        
        local Tab = {}
        local TabId = #Tabs + 1
        
        -- Create Tab Button
        local TabButton = Instance.new("TextButton")
        TabButton.Name = "TabButton_" .. TabId
        TabButton.Text = ""
        TabButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        TabButton.BackgroundTransparency = 0.5
        TabButton.Size = UDim2.new(1, -10, 0, 45)
        TabButton.LayoutOrder = TabId
        TabButton.Parent = TabScroll
        
        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.CornerRadius = UDim.new(0, 6)
        ButtonCorner.Parent = TabButton
        
        local Icon = Instance.new("ImageLabel")
        Icon.Name = "Icon"
        Icon.Image = Icons[TabConfig.Icon] or TabConfig.Icon or Icons.home
        Icon.ImageColor3 = Color3.fromRGB(150, 150, 150)
        Icon.BackgroundTransparency = 1
        Icon.Size = UDim2.new(0, 20, 0, 20)
        Icon.Position = UDim2.new(0, 10, 0.5, -10)
        Icon.Parent = TabButton
        
        local Label = Instance.new("TextLabel")
        Label.Name = "Label"
        Label.Text = TabConfig.Name
        Label.TextColor3 = Color3.fromRGB(200, 200, 200)
        Label.Font = Enum.Font.GothamBold
        Label.TextSize = 13
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.BackgroundTransparency = 1
        Label.Size = UDim2.new(1, -40, 1, 0)
        Label.Position = UDim2.new(0, 40, 0, 0)
        Label.Parent = TabButton
        
        if TabConfig.Description ~= "" then
            local Desc = Instance.new("TextLabel")
            Desc.Name = "Description"
            Desc.Text = TabConfig.Description
            Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
            Desc.Font = Enum.Font.Gotham
            Desc.TextSize = 11
            Desc.TextXAlignment = Enum.TextXAlignment.Left
            Desc.BackgroundTransparency = 1
            Desc.Size = UDim2.new(1, -40, 0, 12)
            Desc.Position = UDim2.new(0, 40, 0, 20)
            Desc.Parent = TabButton
        end
        
        local Highlight = Instance.new("Frame")
        Highlight.Name = "Highlight"
        Highlight.BackgroundColor3 = WindowConfig.Color
        Highlight.BackgroundTransparency = 0.8
        Highlight.Size = UDim2.new(0, 3, 1, -10)
        Highlight.Position = UDim2.new(0, 3, 0, 5)
        Highlight.Visible = false
        Highlight.Parent = TabButton
        
        -- Create Content Container
        local ContentContainer = Instance.new("Frame")
        ContentContainer.Name = "TabContent_" .. TabId
        ContentContainer.BackgroundTransparency = 1
        ContentContainer.Size = UDim2.new(1, 0, 0, 0)
        ContentContainer.Visible = false
        ContentContainer.LayoutOrder = TabId
        ContentContainer.Parent = ContentScroll
        
        local ContentContainerList = Instance.new("UIListLayout")
        ContentContainerList.Padding = UDim.new(0, 10)
        ContentContainerList.SortOrder = Enum.SortOrder.LayoutOrder
        ContentContainerList.Parent = ContentContainer
        
        ContentContainerList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            ContentContainer.Size = UDim2.new(1, 0, 0, ContentContainerList.AbsoluteContentSize.Y)
        end)
        
        -- Tab Selection
        TabButton.MouseButton1Click:Connect(function()
            RippleClick(TabButton, Mouse.X, Mouse.Y)
            
            -- Update all tabs
            for _, tabBtn in pairs(TabScroll:GetChildren()) do
                if tabBtn:IsA("TextButton") then
                    tabBtn.Highlight.Visible = false
                    TweenService:Create(tabBtn, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.5
                    }):Play()
                    TweenService:Create(tabBtn.Icon, TweenInfo.new(0.2), {
                        ImageColor3 = Color3.fromRGB(150, 150, 150)
                    }):Play()
                    TweenService:Create(tabBtn.Label, TweenInfo.new(0.2), {
                        TextColor3 = Color3.fromRGB(200, 200, 200)
                    }):Play()
                end
            end
            
            -- Hide all content
            for _, content in pairs(ContentScroll:GetChildren()) do
                if content.Name:match("TabContent_") then
                    content.Visible = false
                end
            end
            
            -- Show selected tab
            Highlight.Visible = true
            TweenService:Create(TabButton, TweenInfo.new(0.2), {
                BackgroundTransparency = 0.3
            }):Play()
            TweenService:Create(Icon, TweenInfo.new(0.2), {
                ImageColor3 = WindowConfig.Color
            }):Play()
            TweenService:Create(Label, TweenInfo.new(0.2), {
                TextColor3 = Color3.fromRGB(255, 255, 255)
            }):Play()
            
            ContentContainer.Visible = true
            TabTitle.Text = TabConfig.Name
            ActiveTab = TabId
        end)
        
        -- Set first tab as active
        if TabId == 1 then
            TabButton.MouseButton1Click:Fire()
        end
        
        -- Section System
        function Tab:AddSection(SectionConfig)
            SectionConfig = SectionConfig or {}
            SectionConfig.Title = SectionConfig.Title or "Section"
            SectionConfig.Description = SectionConfig.Description or ""
            SectionConfig.Collapsible = SectionConfig.Collapsible ~= false
            SectionConfig.Collapsed = SectionConfig.Collapsed or false
            
            local Section = {}
            local SectionId = #ContentContainer:GetChildren() + 1
            
            -- Create Section Container
            local SectionContainer = Instance.new("Frame")
            SectionContainer.Name = "Section_" .. SectionId
            SectionContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
            SectionContainer.BackgroundTransparency = 0.1
            SectionContainer.Size = UDim2.new(1, 0, 0, 50)
            SectionContainer.LayoutOrder = SectionId
            SectionContainer.Parent = ContentContainer
            
            local SectionCorner = Instance.new("UICorner")
            SectionCorner.CornerRadius = UDim.new(0, 8)
            SectionCorner.Parent = SectionContainer
            
            -- Section Header
            local SectionHeader = Instance.new("Frame")
            SectionHeader.Name = "Header"
            SectionHeader.BackgroundTransparency = 1
            SectionHeader.Size = UDim2.new(1, 0, 0, 40)
            SectionHeader.Parent = SectionContainer
            
            local Title = Instance.new("TextLabel")
            Title.Name = "Title"
            Title.Text = SectionConfig.Title
            Title.TextColor3 = Color3.fromRGB(255, 255, 255)
            Title.Font = Enum.Font.GothamBold
            Title.TextSize = 14
            Title.TextXAlignment = Enum.TextXAlignment.Left
            Title.BackgroundTransparency = 1
            Title.Size = UDim2.new(1, -40, 0, 20)
            Title.Position = UDim2.new(0, 10, 0, 10)
            Title.Parent = SectionHeader
            
            if SectionConfig.Description ~= "" then
                local Desc = Instance.new("TextLabel")
                Desc.Name = "Description"
                Desc.Text = SectionConfig.Description
                Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                Desc.Font = Enum.Font.Gotham
                Desc.TextSize = 11
                Desc.TextXAlignment = Enum.TextXAlignment.Left
                Desc.BackgroundTransparency = 1
                Desc.Size = UDim2.new(1, -40, 0, 12)
                Desc.Position = UDim2.new(0, 10, 0, 25)
                Desc.Parent = SectionHeader
            end
            
            local ToggleButton
            if SectionConfig.Collapsible then
                ToggleButton = Instance.new("ImageButton")
                ToggleButton.Name = "Toggle"
                ToggleButton.Image = "rbxassetid://16851841101"
                ToggleButton.ImageColor3 = Color3.fromRGB(150, 150, 150)
                ToggleButton.BackgroundTransparency = 1
                ToggleButton.Size = UDim2.new(0, 20, 0, 20)
                ToggleButton.Position = UDim2.new(1, -30, 0.5, -10)
                ToggleButton.Parent = SectionHeader
                
                if SectionConfig.Collapsed then
                    ToggleButton.Rotation = -90
                end
            end
            
            -- Content Area
            local ContentArea = Instance.new("Frame")
            ContentArea.Name = "Content"
            ContentArea.BackgroundTransparency = 1
            ContentArea.Size = UDim2.new(1, 0, 0, 0)
            ContentArea.Position = UDim2.new(0, 0, 0, 45)
            ContentArea.Visible = not SectionConfig.Collapsed
            ContentArea.Parent = SectionContainer
            
            local ContentList = Instance.new("UIListLayout")
            ContentList.Padding = UDim.new(0, 8)
            ContentList.SortOrder = Enum.SortOrder.LayoutOrder
            ContentList.Parent = ContentArea
            
            ContentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                ContentArea.Size = UDim2.new(1, 0, 0, ContentList.AbsoluteContentSize.Y)
                SectionContainer.Size = UDim2.new(1, 0, 0, ContentArea.Visible and ContentList.AbsoluteContentSize.Y + 45 or 45)
            end)
            
            -- Toggle Functionality
            if SectionConfig.Collapsible then
                ToggleButton.MouseButton1Click:Connect(function()
                    SectionConfig.Collapsed = not SectionConfig.Collapsed
                    ContentArea.Visible = not SectionConfig.Collapsed
                    
                    TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                        Rotation = SectionConfig.Collapsed and -90 or 0
                    }):Play()
                    
                    SectionContainer.Size = UDim2.new(1, 0, 0, 
                        ContentArea.Visible and ContentList.AbsoluteContentSize.Y + 45 or 45
                    )
                end)
            end
            
            -- Section Methods
            function Section:SetTitle(newTitle)
                Title.Text = newTitle
            end
            
            function Section:SetDescription(newDesc)
                if SectionHeader:FindFirstChild("Description") then
                    SectionHeader.Description.Text = newDesc
                else
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = newDesc
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -40, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 25)
                    Desc.Parent = SectionHeader
                end
            end
            
            function Section:Toggle()
                if SectionConfig.Collapsible then
                    ToggleButton.MouseButton1Click:Fire()
                end
            end
            
            function Section:IsCollapsed()
                return SectionConfig.Collapsed
            end
            
            -- Elements
            local Elements = {}
            
            function Elements:AddLabel(LabelConfig)
                LabelConfig = LabelConfig or {}
                LabelConfig.Text = LabelConfig.Text or "Label"
                LabelConfig.Color = LabelConfig.Color or Color3.fromRGB(255, 255, 255)
                LabelConfig.Size = LabelConfig.Size or 14
                LabelConfig.Font = LabelConfig.Font or Enum.Font.GothamBold
                LabelConfig.Alignment = LabelConfig.Alignment or Enum.TextXAlignment.Left
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = LabelConfig.Text
                Label.TextColor3 = LabelConfig.Color
                Label.Font = LabelConfig.Font
                Label.TextSize = LabelConfig.Size
                Label.TextXAlignment = LabelConfig.Alignment
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, 0, 0, LabelConfig.Size + 4)
                Label.LayoutOrder = #ContentArea:GetChildren() + 1
                Label.Parent = ContentArea
                
                return Label
            end
            
            function Elements:AddParagraph(ParagraphConfig)
                ParagraphConfig = ParagraphConfig or {}
                ParagraphConfig.Title = ParagraphConfig.Title or "Title"
                ParagraphConfig.Content = ParagraphConfig.Content or "Content"
                ParagraphConfig.Color = ParagraphConfig.Color or Color3.fromRGB(200, 200, 200)
                
                local Paragraph = Instance.new("Frame")
                Paragraph.Name = "Paragraph"
                Paragraph.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                Paragraph.BackgroundTransparency = 0.2
                Paragraph.Size = UDim2.new(1, 0, 0, 60)
                Paragraph.LayoutOrder = #ContentArea:GetChildren() + 1
                Paragraph.Parent = ContentArea
                
                local ParagraphCorner = Instance.new("UICorner")
                ParagraphCorner.CornerRadius = UDim.new(0, 6)
                ParagraphCorner.Parent = Paragraph
                
                local Title = Instance.new("TextLabel")
                Title.Name = "Title"
                Title.Text = ParagraphConfig.Title
                Title.TextColor3 = Color3.fromRGB(255, 255, 255)
                Title.Font = Enum.Font.GothamBold
                Title.TextSize = 13
                Title.TextXAlignment = Enum.TextXAlignment.Left
                Title.BackgroundTransparency = 1
                Title.Size = UDim2.new(1, -20, 0, 20)
                Title.Position = UDim2.new(0, 10, 0, 10)
                Title.Parent = Paragraph
                
                local Content = Instance.new("TextLabel")
                Content.Name = "Content"
                Content.Text = ParagraphConfig.Content
                Content.TextColor3 = ParagraphConfig.Color
                Content.Font = Enum.Font.Gotham
                Content.TextSize = 12
                Content.TextXAlignment = Enum.TextXAlignment.Left
                Content.TextYAlignment = Enum.TextYAlignment.Top
                Content.BackgroundTransparency = 1
                Content.TextWrapped = true
                Content.Size = UDim2.new(1, -20, 0, 30)
                Content.Position = UDim2.new(0, 10, 0, 30)
                Content.Parent = Paragraph
                
                Content:GetPropertyChangedSignal("TextBounds"):Connect(function()
                    Paragraph.Size = UDim2.new(1, 0, 0, Content.TextBounds.Y + 40)
                end)
                
                local function SetContent(newContent)
                    Content.Text = newContent
                end
                
                local function SetTitle(newTitle)
                    Title.Text = newTitle
                end
                
                return {
                    SetContent = SetContent,
                    SetTitle = SetTitle
                }
            end
            
            function Elements:AddButton(ButtonConfig)
                ButtonConfig = ButtonConfig or {}
                ButtonConfig.Text = ButtonConfig.Text or "Button"
                ButtonConfig.Color = ButtonConfig.Color or WindowConfig.Color
                ButtonConfig.Callback = ButtonConfig.Callback or function() end
                ButtonConfig.Description = ButtonConfig.Description or ""
                ButtonConfig.Icon = ButtonConfig.Icon or nil
                
                local Button = Instance.new("TextButton")
                Button.Name = "Button"
                Button.Text = ""
                Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                Button.BackgroundTransparency = 0.2
                Button.Size = UDim2.new(1, 0, 0, ButtonConfig.Description ~= "" and 50 or 40)
                Button.LayoutOrder = #ContentArea:GetChildren() + 1
                Button.Parent = ContentArea
                
                local ButtonCorner = Instance.new("UICorner")
                ButtonCorner.CornerRadius = UDim.new(0, 6)
                ButtonCorner.Parent = Button
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = ButtonConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, ButtonConfig.Icon and -40 or -20, 0, 20)
                Label.Position = UDim2.new(0, ButtonConfig.Icon and 40 or 10, 0, ButtonConfig.Description ~= "" and 10 or 10)
                Label.Parent = Button
                
                if ButtonConfig.Icon then
                    local Icon = Instance.new("ImageLabel")
                    Icon.Name = "Icon"
                    Icon.Image = Icons[ButtonConfig.Icon] or ButtonConfig.Icon
                    Icon.ImageColor3 = ButtonConfig.Color
                    Icon.BackgroundTransparency = 1
                    Icon.Size = UDim2.new(0, 20, 0, 20)
                    Icon.Position = UDim2.new(0, 10, 0, 10)
                    Icon.Parent = Button
                end
                
                if ButtonConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = ButtonConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, ButtonConfig.Icon and -40 or -20, 0, 12)
                    Desc.Position = UDim2.new(0, ButtonConfig.Icon and 40 or 10, 0, 30)
                    Desc.Parent = Button
                end
                
                Button.MouseButton1Click:Connect(function()
                    RippleClick(Button, Mouse.X, Mouse.Y)
                    ButtonConfig.Callback()
                end)
                
                Button.MouseEnter:Connect(function()
                    TweenService:Create(Button, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.1
                    }):Play()
                end)
                
                Button.MouseLeave:Connect(function()
                    TweenService:Create(Button, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.2
                    }):Play()
                end)
                
                local function SetText(newText)
                    Label.Text = newText
                end
                
                local function SetCallback(newCallback)
                    ButtonConfig.Callback = newCallback
                end
                
                return {
                    SetText = SetText,
                    SetCallback = SetCallback
                }
            end
            
            function Elements:AddToggle(ToggleConfig)
                ToggleConfig = ToggleConfig or {}
                ToggleConfig.Text = ToggleConfig.Text or "Toggle"
                ToggleConfig.Default = ToggleConfig.Default or false
                ToggleConfig.Callback = ToggleConfig.Callback or function() end
                ToggleConfig.Description = ToggleConfig.Description or ""
                
                local configKey = "Toggle_" .. ToggleConfig.Text
                if ConfigData[configKey] ~= nil then
                    ToggleConfig.Default = ConfigData[configKey]
                end
                
                local Toggle = {}
                Toggle.Value = ToggleConfig.Default
                
                local ToggleFrame = Instance.new("TextButton")
                ToggleFrame.Name = "Toggle"
                ToggleFrame.Text = ""
                ToggleFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                ToggleFrame.BackgroundTransparency = 0.2
                ToggleFrame.Size = UDim2.new(1, 0, 0, ToggleConfig.Description ~= "" and 50 : 40)
                ToggleFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                ToggleFrame.Parent = ContentArea
                
                local ToggleCorner = Instance.new("UICorner")
                ToggleCorner.CornerRadius = UDim.new(0, 6)
                ToggleCorner.Parent = ToggleFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = ToggleConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, -60, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, ToggleConfig.Description ~= "" and 10 : 10)
                Label.Parent = ToggleFrame
                
                if ToggleConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = ToggleConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -60, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = ToggleFrame
                end
                
                local ToggleButton = Instance.new("Frame")
                ToggleButton.Name = "ToggleButton"
                ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                ToggleButton.BackgroundTransparency = 0.2
                ToggleButton.Size = UDim2.new(0, 40, 0, 20)
                ToggleButton.Position = UDim2.new(1, -50, 0.5, -10)
                ToggleButton.Parent = ToggleFrame
                
                local ButtonCorner = Instance.new("UICorner")
                ButtonCorner.CornerRadius = UDim.new(0, 10)
                ButtonCorner.Parent = ToggleButton
                
                local ToggleCircle = Instance.new("Frame")
                ToggleCircle.Name = "Circle"
                ToggleCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                ToggleCircle.Size = UDim2.new(0, 16, 0, 16)
                ToggleCircle.Position = UDim2.new(0, 2, 0.5, -8)
                ToggleCircle.Parent = ToggleButton
                
                local CircleCorner = Instance.new("UICorner")
                CircleCorner.CornerRadius = UDim.new(0, 8)
                CircleCorner.Parent = ToggleCircle
                
                local function UpdateToggle()
                    if Toggle.Value then
                        TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                            BackgroundColor3 = WindowConfig.Color
                        }):Play()
                        TweenService:Create(ToggleCircle, TweenInfo.new(0.2), {
                            Position = UDim2.new(0, 22, 0.5, -8)
                        }):Play()
                        TweenService:Create(Label, TweenInfo.new(0.2), {
                            TextColor3 = WindowConfig.Color
                        }):Play()
                    else
                        TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                            BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                        }):Play()
                        TweenService:Create(ToggleCircle, TweenInfo.new(0.2), {
                            Position = UDim2.new(0, 2, 0.5, -8)
                        }):Play()
                        TweenService:Create(Label, TweenInfo.new(0.2), {
                            TextColor3 = Color3.fromRGB(255, 255, 255)
                        }):Play()
                    end
                end
                
                function Toggle:Set(Value, NoCallback)
                    Toggle.Value = Value
                    UpdateToggle()
                    ConfigData[configKey] = Value
                    SaveConfig()
                    
                    if not NoCallback then
                        ToggleConfig.Callback(Value)
                    end
                end
                
                function Toggle:Get()
                    return Toggle.Value
                end
                
                function Toggle:Toggle()
                    Toggle:Set(not Toggle.Value)
                end
                
                ToggleFrame.MouseButton1Click:Connect(function()
                    Toggle:Toggle()
                end)
                
                Elements[configKey] = Toggle
                Toggle:Set(ToggleConfig.Default, true)
                
                return Toggle
            end
            
            function Elements:AddSlider(SliderConfig)
                SliderConfig = SliderConfig or {}
                SliderConfig.Text = SliderConfig.Text or "Slider"
                SliderConfig.Min = SliderConfig.Min or 0
                SliderConfig.Max = SliderConfig.Max or 100
                SliderConfig.Default = SliderConfig.Default or 50
                SliderConfig.Increment = SliderConfig.Increment or 1
                SliderConfig.Callback = SliderConfig.Callback or function() end
                SliderConfig.Description = SliderConfig.Description or ""
                SliderConfig.ShowValue = SliderConfig.ShowValue ~= false
                
                local configKey = "Slider_" .. SliderConfig.Text
                if ConfigData[configKey] ~= nil then
                    SliderConfig.Default = ConfigData[configKey]
                end
                
                local Slider = {}
                Slider.Value = SliderConfig.Default
                
                local SliderFrame = Instance.new("Frame")
                SliderFrame.Name = "Slider"
                SliderFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                SliderFrame.BackgroundTransparency = 0.2
                SliderFrame.Size = UDim2.new(1, 0, 0, 60)
                SliderFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                SliderFrame.Parent = ContentArea
                
                local SliderCorner = Instance.new("UICorner")
                SliderCorner.CornerRadius = UDim.new(0, 6)
                SliderCorner.Parent = SliderFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = SliderConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, SliderConfig.ShowValue and -60 : -20, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, 10)
                Label.Parent = SliderFrame
                
                if SliderConfig.ShowValue then
                    local ValueLabel = Instance.new("TextLabel")
                    ValueLabel.Name = "Value"
                    ValueLabel.Text = tostring(SliderConfig.Default)
                    ValueLabel.TextColor3 = WindowConfig.Color
                    ValueLabel.Font = Enum.Font.GothamBold
                    ValueLabel.TextSize = 13
                    ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
                    ValueLabel.BackgroundTransparency = 1
                    ValueLabel.Size = UDim2.new(0, 40, 0, 20)
                    ValueLabel.Position = UDim2.new(1, -50, 0, 10)
                    ValueLabel.Parent = SliderFrame
                end
                
                if SliderConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = SliderConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -20, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = SliderFrame
                end
                
                local SliderTrack = Instance.new("Frame")
                SliderTrack.Name = "Track"
                SliderTrack.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                SliderTrack.Size = UDim2.new(1, -20, 0, 4)
                SliderTrack.Position = UDim2.new(0, 10, 1, -14)
                SliderTrack.Parent = SliderFrame
                
                local TrackCorner = Instance.new("UICorner")
                TrackCorner.CornerRadius = UDim.new(0, 2)
                TrackCorner.Parent = SliderTrack
                
                local SliderFill = Instance.new("Frame")
                SliderFill.Name = "Fill"
                SliderFill.BackgroundColor3 = WindowConfig.Color
                SliderFill.Size = UDim2.new(
                    (SliderConfig.Default - SliderConfig.Min) / (SliderConfig.Max - SliderConfig.Min),
                    0, 1, 0
                )
                SliderFill.Parent = SliderTrack
                
                local FillCorner = Instance.new("UICorner")
                FillCorner.CornerRadius = UDim.new(0, 2)
                FillCorner.Parent = SliderFill
                
                local SliderButton = Instance.new("TextButton")
                SliderButton.Name = "Button"
                SliderButton.Text = ""
                SliderButton.BackgroundTransparency = 1
                SliderButton.Size = UDim2.new(1, 0, 1, 0)
                SliderButton.Parent = SliderFrame
                
                local dragging = false
                
                local function CalculateValue(x)
                    local relativeX = (x - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X
                    relativeX = math.clamp(relativeX, 0, 1)
                    
                    local value = SliderConfig.Min + (relativeX * (SliderConfig.Max - SliderConfig.Min))
                    value = math.floor(value / SliderConfig.Increment) * SliderConfig.Increment
                    value = math.clamp(value, SliderConfig.Min, SliderConfig.Max)
                    
                    return value
                end
                
                function Slider:Set(Value, NoCallback)
                    Value = math.clamp(Value, SliderConfig.Min, SliderConfig.Max)
                    Slider.Value = Value
                    
                    local ratio = (Value - SliderConfig.Min) / (SliderConfig.Max - SliderConfig.Min)
                    TweenService:Create(SliderFill, TweenInfo.new(0.1), {
                        Size = UDim2.new(ratio, 0, 1, 0)
                    }):Play()
                    
                    if SliderConfig.ShowValue then
                        SliderFrame.Value.Text = tostring(Value)
                    end
                    
                    ConfigData[configKey] = Value
                    SaveConfig()
                    
                    if not NoCallback then
                        SliderConfig.Callback(Value)
                    end
                end
                
                function Slider:Get()
                    return Slider.Value
                end
                
                SliderButton.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = true
                        local value = CalculateValue(input.Position.X)
                        Slider:Set(value)
                    end
                end)
                
                SliderButton.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = false
                    end
                end)
                
                UserInputService.InputChanged:Connect(function(input)
                    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                        local value = CalculateValue(input.Position.X)
                        Slider:Set(value)
                    end
                end)
                
                Elements[configKey] = Slider
                Slider:Set(SliderConfig.Default, true)
                
                return Slider
            end
            
            function Elements:AddDropdown(DropdownConfig)
                DropdownConfig = DropdownConfig or {}
                DropdownConfig.Text = DropdownConfig.Text or "Dropdown"
                DropdownConfig.Options = DropdownConfig.Options or {}
                DropdownConfig.Default = DropdownConfig.Default or DropdownConfig.Options[1]
                DropdownConfig.Callback = DropdownConfig.Callback or function() end
                DropdownConfig.Multiple = DropdownConfig.Multiple or false
                DropdownConfig.Description = DropdownConfig.Description or ""
                
                local configKey = "Dropdown_" .. DropdownConfig.Text
                if ConfigData[configKey] ~= nil then
                    DropdownConfig.Default = ConfigData[configKey]
                end
                
                local Dropdown = {}
                Dropdown.Value = DropdownConfig.Multiple and {} or DropdownConfig.Default
                Dropdown.Options = DropdownConfig.Options
                
                local DropdownFrame = Instance.new("TextButton")
                DropdownFrame.Name = "Dropdown"
                DropdownFrame.Text = ""
                DropdownFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                DropdownFrame.BackgroundTransparency = 0.2
                DropdownFrame.Size = UDim2.new(1, 0, 0, DropdownConfig.Description ~= "" and 50 : 40)
                DropdownFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                DropdownFrame.Parent = ContentArea
                
                local DropdownCorner = Instance.new("UICorner")
                DropdownCorner.CornerRadius = UDim.new(0, 6)
                DropdownCorner.Parent = DropdownFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = DropdownConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, -60, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, DropdownConfig.Description ~= "" and 10 : 10)
                Label.Parent = DropdownFrame
                
                if DropdownConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = DropdownConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -60, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = DropdownFrame
                end
                
                local SelectedLabel = Instance.new("TextLabel")
                SelectedLabel.Name = "Selected"
                SelectedLabel.Text = DropdownConfig.Multiple and "Select..." or (DropdownConfig.Default or "Select...")
                SelectedLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
                SelectedLabel.Font = Enum.Font.Gotham
                SelectedLabel.TextSize = 12
                SelectedLabel.TextXAlignment = Enum.TextXAlignment.Right
                SelectedLabel.BackgroundTransparency = 1
                SelectedLabel.Size = UDim2.new(0, 100, 0, 20)
                SelectedLabel.Position = UDim2.new(1, -120, 0, DropdownConfig.Description ~= "" and 10 : 10)
                SelectedLabel.Parent = DropdownFrame
                
                local Arrow = Instance.new("ImageLabel")
                Arrow.Name = "Arrow"
                Arrow.Image = "rbxassetid://16851841101"
                Arrow.ImageColor3 = Color3.fromRGB(150, 150, 150)
                Arrow.Rotation = -90
                Arrow.BackgroundTransparency = 1
                Arrow.Size = UDim2.new(0, 20, 0, 20)
                Arrow.Position = UDim2.new(1, -30, 0.5, -10)
                Arrow.Parent = DropdownFrame
                
                -- Dropdown Menu
                local DropdownMenu = Instance.new("Frame")
                DropdownMenu.Name = "DropdownMenu"
                DropdownMenu.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                DropdownMenu.BackgroundTransparency = 0.1
                DropdownMenu.Size = UDim2.new(1, 0, 0, 0)
                DropdownMenu.Position = UDim2.new(0, 0, 1, 5)
                DropdownMenu.Visible = false
                DropdownMenu.Parent = DropdownFrame
                
                local MenuCorner = Instance.new("UICorner")
                MenuCorner.CornerRadius = UDim.new(0, 6)
                MenuCorner.Parent = DropdownMenu
                
                local MenuScroll = Instance.new("ScrollingFrame")
                MenuScroll.Name = "Scroll"
                MenuScroll.BackgroundTransparency = 1
                MenuScroll.Size = UDim2.new(1, 0, 1, 0)
                MenuScroll.ScrollBarThickness = 3
                MenuScroll.ScrollBarImageColor3 = WindowConfig.Color
                MenuScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
                MenuScroll.Parent = DropdownMenu
                
                local MenuList = Instance.new("UIListLayout")
                MenuList.Padding = UDim.new(0, 2)
                MenuList.SortOrder = Enum.SortOrder.LayoutOrder
                MenuList.Parent = MenuScroll
                
                MenuList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                    MenuScroll.CanvasSize = UDim2.new(0, 0, 0, MenuList.AbsoluteContentSize.Y)
                    DropdownMenu.Size = UDim2.new(1, 0, 0, math.min(MenuList.AbsoluteContentSize.Y, 200))
                end)
                
                local function UpdateSelectedText()
                    if DropdownConfig.Multiple then
                        if #Dropdown.Value == 0 then
                            SelectedLabel.Text = "Select..."
                        else
                            SelectedLabel.Text = #Dropdown.Value .. " selected"
                        end
                    else
                        SelectedLabel.Text = tostring(Dropdown.Value) or "Select..."
                    end
                end
                
                local function CreateOption(option, index)
                    local OptionButton = Instance.new("TextButton")
                    OptionButton.Name = "Option_" .. index
                    OptionButton.Text = ""
                    OptionButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                    OptionButton.BackgroundTransparency = 0.5
                    OptionButton.Size = UDim2.new(1, 0, 0, 30)
                    OptionButton.LayoutOrder = index
                    OptionButton.Parent = MenuScroll
                    
                    local OptionCorner = Instance.new("UICorner")
                    OptionCorner.CornerRadius = UDim.new(0, 4)
                    OptionCorner.Parent = OptionButton
                    
                    local OptionLabel = Instance.new("TextLabel")
                    OptionLabel.Name = "Label"
                    OptionLabel.Text = tostring(option)
                    OptionLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                    OptionLabel.Font = Enum.Font.Gotham
                    OptionLabel.TextSize = 12
                    OptionLabel.TextXAlignment = Enum.TextXAlignment.Left
                    OptionLabel.BackgroundTransparency = 1
                    OptionLabel.Size = UDim2.new(1, -30, 1, 0)
                    OptionLabel.Position = UDim2.new(0, 10, 0, 0)
                    OptionLabel.Parent = OptionButton
                    
                    local CheckIcon = Instance.new("ImageLabel")
                    CheckIcon.Name = "Check"
                    CheckIcon.Image = "rbxassetid://6031302933"
                    CheckIcon.ImageColor3 = WindowConfig.Color
                    CheckIcon.BackgroundTransparency = 1
                    CheckIcon.Size = UDim2.new(0, 16, 0, 16)
                    CheckIcon.Position = UDim2.new(1, -26, 0.5, -8)
                    CheckIcon.Visible = false
                    CheckIcon.Parent = OptionButton
                    
                    OptionButton.MouseButton1Click:Connect(function()
                        if DropdownConfig.Multiple then
                            local found = false
                            for i, v in ipairs(Dropdown.Value) do
                                if v == option then
                                    table.remove(Dropdown.Value, i)
                                    found = true
                                    break
                                end
                            end
                            
                            if not found then
                                table.insert(Dropdown.Value, option)
                            end
                            
                            CheckIcon.Visible = found
                        else
                            Dropdown.Value = option
                            DropdownMenu.Visible = false
                            Arrow.Rotation = -90
                            
                            -- Update all options
                            for _, optBtn in pairs(MenuScroll:GetChildren()) do
                                if optBtn:IsA("TextButton") then
                                    optBtn.Check.Visible = optBtn.Label.Text == tostring(option)
                                end
                            end
                        end
                        
                        UpdateSelectedText()
                        ConfigData[configKey] = Dropdown.Value
                        SaveConfig()
                        DropdownConfig.Callback(Dropdown.Value)
                    end)
                    
                    -- Set initial state
                    if DropdownConfig.Multiple then
                        for _, v in ipairs(Dropdown.Value) do
                            if v == option then
                                CheckIcon.Visible = true
                                break
                            end
                        end
                    else
                        CheckIcon.Visible = Dropdown.Value == option
                    end
                    
                    OptionButton.MouseEnter:Connect(function()
                        TweenService:Create(OptionButton, TweenInfo.new(0.2), {
                            BackgroundTransparency = 0.3
                        }):Play()
                    end)
                    
                    OptionButton.MouseLeave:Connect(function()
                        TweenService:Create(OptionButton, TweenInfo.new(0.2), {
                            BackgroundTransparency = 0.5
                        }):Play()
                    end)
                end
                
                -- Create options
                for i, option in ipairs(DropdownConfig.Options) do
                    CreateOption(option, i)
                end
                
                function Dropdown:Set(Value, NoCallback)
                    if DropdownConfig.Multiple then
                        Dropdown.Value = type(Value) == "table" and Value or {}
                    else
                        Dropdown.Value = Value
                    end
                    
                    UpdateSelectedText()
                    ConfigData[configKey] = Dropdown.Value
                    SaveConfig()
                    
                    if not NoCallback then
                        DropdownConfig.Callback(Dropdown.Value)
                    end
                end
                
                function Dropdown:Get()
                    return Dropdown.Value
                end
                
                function Dropdown:AddOption(option)
                    table.insert(DropdownConfig.Options, option)
                    CreateOption(option, #DropdownConfig.Options)
                end
                
                function Dropdown:RemoveOption(option)
                    for i, v in ipairs(DropdownConfig.Options) do
                        if v == option then
                            table.remove(DropdownConfig.Options, i)
                            
                            local optBtn = MenuScroll:FindFirstChild("Option_" .. i)
                            if optBtn then
                                optBtn:Destroy()
                            end
                            
                            break
                        end
                    end
                end
                
                function Dropdown:Clear()
                    DropdownConfig.Options = {}
                    Dropdown.Value = DropdownConfig.Multiple and {} or nil
                    
                    for _, child in pairs(MenuScroll:GetChildren()) do
                        if child:IsA("TextButton") then
                            child:Destroy()
                        end
                    end
                    
                    UpdateSelectedText()
                end
                
                DropdownFrame.MouseButton1Click:Connect(function()
                    DropdownMenu.Visible = not DropdownMenu.Visible
                    Arrow.Rotation = DropdownMenu.Visible and 90 or -90
                    
                    if DropdownMenu.Visible then
                        -- Close other dropdowns
                        for _, section in pairs(ContentArea:GetChildren()) do
                            if section:IsA("Frame") and section ~= DropdownFrame then
                                local menu = section:FindFirstChild("DropdownMenu")
                                if menu and menu.Visible then
                                    menu.Visible = false
                                    local arrow = section:FindFirstChild("Arrow")
                                    if arrow then
                                        arrow.Rotation = -90
                                    end
                                end
                            end
                        end
                    end
                end)
                
                -- Close dropdown when clicking outside
                local function CloseDropdown()
                    if DropdownMenu.Visible then
                        DropdownMenu.Visible = false
                        Arrow.Rotation = -90
                    end
                end
                
                UserInputService.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        if not DropdownFrame:IsDescendantOf(Mouse.Target) then
                            CloseDropdown()
                        end
                    end
                end)
                
                Elements[configKey] = Dropdown
                Dropdown:Set(DropdownConfig.Default, true)
                
                return Dropdown
            end
            
            function Elements:AddInput(InputConfig)
                InputConfig = InputConfig or {}
                InputConfig.Text = InputConfig.Text or "Input"
                InputConfig.Default = InputConfig.Default or ""
                InputConfig.Placeholder = InputConfig.Placeholder or "Enter text..."
                InputConfig.Callback = InputConfig.Callback or function() end
                InputConfig.Description = InputConfig.Description or ""
                
                local configKey = "Input_" .. InputConfig.Text
                if ConfigData[configKey] ~= nil then
                    InputConfig.Default = ConfigData[configKey]
                end
                
                local Input = {}
                Input.Value = InputConfig.Default
                
                local InputFrame = Instance.new("Frame")
                InputFrame.Name = "Input"
                InputFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                InputFrame.BackgroundTransparency = 0.2
                InputFrame.Size = UDim2.new(1, 0, 0, InputConfig.Description ~= "" and 60 : 50)
                InputFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                InputFrame.Parent = ContentArea
                
                local InputCorner = Instance.new("UICorner")
                InputCorner.CornerRadius = UDim.new(0, 6)
                InputCorner.Parent = InputFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = InputConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, -20, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, 10)
                Label.Parent = InputFrame
                
                if InputConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = InputConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -20, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = InputFrame
                end
                
                local TextBox = Instance.new("TextBox")
                TextBox.Name = "TextBox"
                TextBox.Text = InputConfig.Default
                TextBox.PlaceholderText = InputConfig.Placeholder
                TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
                TextBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
                TextBox.Font = Enum.Font.Gotham
                TextBox.TextSize = 12
                TextBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                TextBox.BackgroundTransparency = 0.2
                TextBox.Size = UDim2.new(1, -20, 0, 30)
                TextBox.Position = UDim2.new(0, 10, 1, -40)
                TextBox.Parent = InputFrame
                
                local BoxCorner = Instance.new("UICorner")
                BoxCorner.CornerRadius = UDim.new(0, 4)
                BoxCorner.Parent = TextBox
                
                function Input:Set(Value, NoCallback)
                    Input.Value = Value
                    TextBox.Text = Value
                    
                    ConfigData[configKey] = Value
                    SaveConfig()
                    
                    if not NoCallback then
                        InputConfig.Callback(Value)
                    end
                end
                
                function Input:Get()
                    return Input.Value
                end
                
                function Input:Clear()
                    Input:Set("")
                end
                
                TextBox.FocusLost:Connect(function()
                    Input:Set(TextBox.Text)
                end)
                
                Elements[configKey] = Input
                Input:Set(InputConfig.Default, true)
                
                return Input
            end
            
            function Elements:AddKeybind(KeybindConfig)
                KeybindConfig = KeybindConfig or {}
                KeybindConfig.Text = KeybindConfig.Text or "Keybind"
                KeybindConfig.Default = KeybindConfig.Default or Enum.KeyCode.F
                KeybindConfig.Callback = KeybindConfig.Callback or function() end
                KeybindConfig.Description = KeybindConfig.Description or ""
                
                local configKey = "Keybind_" .. KeybindConfig.Text
                if ConfigData[configKey] ~= nil then
                    KeybindConfig.Default = Enum.KeyCode[ConfigData[configKey]]
                end
                
                local Keybind = {}
                Keybind.Value = KeybindConfig.Default
                Keybind.Listening = false
                
                local KeybindFrame = Instance.new("TextButton")
                KeybindFrame.Name = "Keybind"
                KeybindFrame.Text = ""
                KeybindFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                KeybindFrame.BackgroundTransparency = 0.2
                KeybindFrame.Size = UDim2.new(1, 0, 0, KeybindConfig.Description ~= "" and 50 : 40)
                KeybindFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                KeybindFrame.Parent = ContentArea
                
                local KeybindCorner = Instance.new("UICorner")
                KeybindCorner.CornerRadius = UDim.new(0, 6)
                KeybindCorner.Parent = KeybindFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = KeybindConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, -100, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, KeybindConfig.Description ~= "" and 10 : 10)
                Label.Parent = KeybindFrame
                
                if KeybindConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = KeybindConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -100, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = KeybindFrame
                end
                
                local KeyLabel = Instance.new("TextButton")
                KeyLabel.Name = "KeyLabel"
                KeyLabel.Text = Keybind.Value.Name
                KeyLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                KeyLabel.Font = Enum.Font.GothamBold
                KeyLabel.TextSize = 12
                KeyLabel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                KeyLabel.BackgroundTransparency = 0.2
                KeyLabel.Size = UDim2.new(0, 80, 0, 25)
                KeyLabel.Position = UDim2.new(1, -90, 0.5, -12.5)
                KeyLabel.Parent = KeybindFrame
                
                local KeyCorner = Instance.new("UICorner")
                KeyCorner.CornerRadius = UDim.new(0, 4)
                KeyCorner.Parent = KeyLabel
                
                function Keybind:Set(Key, NoCallback)
                    Keybind.Value = Key
                    KeyLabel.Text = Key.Name
                    
                    ConfigData[configKey] = Key.Name
                    SaveConfig()
                    
                    if not NoCallback then
                        KeybindConfig.Callback(Key)
                    end
                end
                
                function Keybind:Get()
                    return Keybind.Value
                end
                
                function Keybind:StartListening()
                    Keybind.Listening = true
                    KeyLabel.Text = "..."
                    KeyLabel.BackgroundColor3 = WindowConfig.Color
                    
                    local connection
                    connection = UserInputService.InputBegan:Connect(function(input)
                        if input.UserInputType == Enum.UserInputType.Keyboard then
                            Keybind:Set(input.KeyCode)
                            Keybind.Listening = false
                            KeyLabel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                            connection:Disconnect()
                        elseif input.UserInputType == Enum.UserInputType.MouseButton1 then
                            Keybind:Set(Enum.KeyCode.MouseButton1)
                            Keybind.Listening = false
                            KeyLabel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                            connection:Disconnect()
                        elseif input.UserInputType == Enum.UserInputType.MouseButton2 then
                            Keybind:Set(Enum.KeyCode.MouseButton2)
                            Keybind.Listening = false
                            KeyLabel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                            connection:Disconnect()
                        end
                    end)
                end
                
                KeyLabel.MouseButton1Click:Connect(function()
                    if not Keybind.Listening then
                        Keybind:StartListening()
                    end
                end)
                
                -- Clear listening on escape
                UserInputService.InputBegan:Connect(function(input)
                    if Keybind.Listening and input.KeyCode == Enum.KeyCode.Escape then
                        Keybind.Listening = false
                        KeyLabel.Text = Keybind.Value.Name
                        KeyLabel.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                    end
                end)
                
                Elements[configKey] = Keybind
                Keybind:Set(KeybindConfig.Default, true)
                
                return Keybind
            end
            
            function Elements:AddColorPicker(ColorConfig)
                ColorConfig = ColorConfig or {}
                ColorConfig.Text = ColorConfig.Text or "Color Picker"
                ColorConfig.Default = ColorConfig.Default or Color3.fromRGB(255, 255, 255)
                ColorConfig.Callback = ColorConfig.Callback or function() end
                ColorConfig.Description = ColorConfig.Description or ""
                
                local configKey = "Color_" .. ColorConfig.Text
                if ConfigData[configKey] ~= nil then
                    ColorConfig.Default = Color3.fromRGB(
                        ConfigData[configKey].R * 255,
                        ConfigData[configKey].G * 255,
                        ConfigData[configKey].B * 255
                    )
                end
                
                local ColorPicker = {}
                ColorPicker.Value = ColorConfig.Default
                
                local ColorFrame = Instance.new("TextButton")
                ColorFrame.Name = "ColorPicker"
                ColorFrame.Text = ""
                ColorFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                ColorFrame.BackgroundTransparency = 0.2
                ColorFrame.Size = UDim2.new(1, 0, 0, ColorConfig.Description ~= "" and 50 : 40)
                ColorFrame.LayoutOrder = #ContentArea:GetChildren() + 1
                ColorFrame.Parent = ContentArea
                
                local ColorCorner = Instance.new("UICorner")
                ColorCorner.CornerRadius = UDim.new(0, 6)
                ColorCorner.Parent = ColorFrame
                
                local Label = Instance.new("TextLabel")
                Label.Name = "Label"
                Label.Text = ColorConfig.Text
                Label.TextColor3 = Color3.fromRGB(255, 255, 255)
                Label.Font = Enum.Font.GothamBold
                Label.TextSize = 13
                Label.TextXAlignment = Enum.TextXAlignment.Left
                Label.BackgroundTransparency = 1
                Label.Size = UDim2.new(1, -70, 0, 20)
                Label.Position = UDim2.new(0, 10, 0, ColorConfig.Description ~= "" and 10 : 10)
                Label.Parent = ColorFrame
                
                if ColorConfig.Description ~= "" then
                    local Desc = Instance.new("TextLabel")
                    Desc.Name = "Description"
                    Desc.Text = ColorConfig.Description
                    Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
                    Desc.Font = Enum.Font.Gotham
                    Desc.TextSize = 11
                    Desc.TextXAlignment = Enum.TextXAlignment.Left
                    Desc.BackgroundTransparency = 1
                    Desc.Size = UDim2.new(1, -70, 0, 12)
                    Desc.Position = UDim2.new(0, 10, 0, 30)
                    Desc.Parent = ColorFrame
                end
                
                local ColorPreview = Instance.new("Frame")
                ColorPreview.Name = "Preview"
                ColorPreview.BackgroundColor3 = ColorConfig.Default
                ColorPreview.Size = UDim2.new(0, 40, 0, 25)
                ColorPreview.Position = UDim2.new(1, -50, 0.5, -12.5)
                ColorPreview.Parent = ColorFrame
                
                local PreviewCorner = Instance.new("UICorner")
                PreviewCorner.CornerRadius = UDim.new(0, 4)
                PreviewCorner.Parent = ColorPreview
                
                local PreviewStroke = Instance.new("UIStroke")
                PreviewStroke.Color = Color3.fromRGB(255, 255, 255)
                PreviewStroke.Thickness = 1
                PreviewStroke.Transparency = 0.5
                PreviewStroke.Parent = ColorPreview
                
                function ColorPicker:Set(Color, NoCallback)
                    ColorPicker.Value = Color
                    ColorPreview.BackgroundColor3 = Color
                    
                    ConfigData[configKey] = {
                        R = Color.R,
                        G = Color.G,
                        B = Color.B
                    }
                    SaveConfig()
                    
                    if not NoCallback then
                        ColorConfig.Callback(Color)
                    end
                end
                
                function ColorPicker:Get()
                    return ColorPicker.Value
                end
                
                ColorFrame.MouseButton1Click:Connect(function()
                    -- Simple color picker
                    local ColorPickerUI = Instance.new("ScreenGui")
                    ColorPickerUI.Name = "ColorPickerUI"
                    ColorPickerUI.Parent = CoreGui
                    
                    local Overlay = Instance.new("Frame")
                    Overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                    Overlay.BackgroundTransparency = 0.5
                    Overlay.Size = UDim2.new(1, 0, 1, 0)
                    Overlay.ZIndex = 100
                    Overlay.Parent = ColorPickerUI
                    
                    local PickerFrame = Instance.new("Frame")
                    PickerFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                    PickerFrame.Size = UDim2.new(0, 300, 0, 200)
                    PickerFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
                    PickerFrame.ZIndex = 101
                    PickerFrame.Parent = ColorPickerUI
                    
                    local PickerCorner = Instance.new("UICorner")
                    PickerCorner.CornerRadius = UDim.new(0, 8)
                    PickerCorner.Parent = PickerFrame
                    
                    local Title = Instance.new("TextLabel")
                    Title.Text = "Select Color"
                    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
                    Title.Font = Enum.Font.GothamBold
                    Title.TextSize = 16
                    Title.BackgroundTransparency = 1
                    Title.Size = UDim2.new(1, 0, 0, 40)
                    Title.Parent = PickerFrame
                    
                    local CloseButton = Instance.new("ImageButton")
                    CloseButton.Image = "rbxassetid://9886659671"
                    CloseButton.ImageColor3 = Color3.fromRGB(150, 150, 150)
                    CloseButton.BackgroundTransparency = 1
                    CloseButton.Size = UDim2.new(0, 25, 0, 25)
                    CloseButton.Position = UDim2.new(1, -30, 0, 7)
                    CloseButton.ZIndex = 102
                    CloseButton.Parent = PickerFrame
                    
                    CloseButton.MouseButton1Click:Connect(function()
                        ColorPickerUI:Destroy()
                    end)
                    
                    -- Simple color grid
                    local ColorGrid = Instance.new("Frame")
                    ColorGrid.BackgroundTransparency = 1
                    ColorGrid.Size = UDim2.new(1, -20, 0, 120)
                    ColorGrid.Position = UDim2.new(0, 10, 0, 50)
                    ColorGrid.Parent = PickerFrame
                    
                    local colors = {
                        Color3.fromRGB(255, 0, 0),
                        Color3.fromRGB(0, 255, 0),
                        Color3.fromRGB(0, 0, 255),
                        Color3.fromRGB(255, 255, 0),
                        Color3.fromRGB(255, 0, 255),
                        Color3.fromRGB(0, 255, 255),
                        Color3.fromRGB(255, 255, 255),
                        Color3.fromRGB(0, 0, 0),
                        WindowConfig.Color,
                        Color3.fromRGB(100, 100, 255),
                        Color3.fromRGB(255, 100, 100),
                        Color3.fromRGB(100, 255, 100)
                    }
                    
                    for i, color in ipairs(colors) do
                        local ColorButton = Instance.new("TextButton")
                        ColorButton.Text = ""
                        ColorButton.BackgroundColor3 = color
                        ColorButton.Size = UDim2.new(0, 40, 0, 40)
                        ColorButton.Position = UDim2.new(
                            ((i - 1) % 4) * 0.25,
                            5,
                            math.floor((i - 1) / 4) * 0.333,
                            5
                        )
                        ColorButton.Parent = ColorGrid
                        
                        local ButtonCorner = Instance.new("UICorner")
                        ButtonCorner.CornerRadius = UDim.new(0, 4)
                        ButtonCorner.Parent = ColorButton
                        
                        local ButtonStroke = Instance.new("UIStroke")
                        ButtonStroke.Color = Color3.fromRGB(255, 255, 255)
                        ButtonStroke.Thickness = 1
                        ButtonStroke.Transparency = 0.5
                        ButtonStroke.Parent = ColorButton
                        
                        ColorButton.MouseButton1Click:Connect(function()
                            ColorPicker:Set(color)
                            ColorPickerUI:Destroy()
                        end)
                    end
                    
                    Overlay.MouseButton1Click:Connect(function()
                        ColorPickerUI:Destroy()
                    end)
                end)
                
                Elements[configKey] = ColorPicker
                ColorPicker:Set(ColorConfig.Default, true)
                
                return ColorPicker
            end
            
            function Elements:AddDivider()
                local Divider = Instance.new("Frame")
                Divider.Name = "Divider"
                Divider.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                Divider.BackgroundTransparency = 0.5
                Divider.Size = UDim2.new(1, 0, 0, 1)
                Divider.LayoutOrder = #ContentArea:GetChildren() + 1
                Divider.Parent = ContentArea
                
                return Divider
            end
            
            function Elements:AddSpacer(Height)
                Height = Height or 10
                
                local Spacer = Instance.new("Frame")
                Spacer.Name = "Spacer"
                Spacer.BackgroundTransparency = 1
                Spacer.Size = UDim2.new(1, 0, 0, Height)
                Spacer.LayoutOrder = #ContentArea:GetChildren() + 1
                Spacer.Parent = ContentArea
                
                return Spacer
            end
            
            -- Return elements container
            return Elements
        end
        
        -- Return tab methods
        return Tab
    end
    
    -- Initialize
    table.insert(Tabs, Window)
    
    -- Auto-load config
    if WindowConfig.AutoLoadConfig then
        LoadConfigElements()
    end
    
    Nt("Nexa Hub v" .. WindowConfig.Version .. " loaded!", 3, WindowConfig.Color)
    
    return Window
end

-- Utility Functions
function Nexa:CreateNotification(Config)
    return NexaNotifications:Notify(Config)
end

function Nexa:GetIcon(Name)
    return Icons[Name]
end

function Nexa:AddIcon(Name, AssetId)
    Icons[Name] = AssetId
end

function Nexa:GetTheme(Name)
    return Themes[Name]
end

function Nexa:SetTheme(Name, Color)
    if Color then
        Themes[Name] = Color
    else
        return Themes[Name]
    end
end

return Nexa
